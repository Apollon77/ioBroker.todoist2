<html>

<head>
    <!-- these 4 files always have to be included -->
    <link rel="stylesheet" type="text/css" href="../../css/adapter.css" />
    <link rel="stylesheet" type="text/css" href="../../lib/css/materialize.css">

    <script type="text/javascript" src="../../lib/js/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="../../socket.io/socket.io.js"></script>

    <!-- these files always have to be included -->
    <script type="text/javascript" src="../../js/translate.js"></script>
    <script type="text/javascript" src="../../lib/js/materialize.js"></script>
    <script type="text/javascript" src="../../js/adapter-settings.js"></script>
    <script type="text/javascript" src="words.js"></script>
    <script type="text/javascript">
        //var isStarted =   null;


        

        function load(settings, onChange) {
            if (!settings) return;
            //$('#tabs').tabs();
            
            

            
            //if (!settings.pollingInterval) settings.pollingInterval = 60000;

            

            //        if (settings.restarted  === undefined || settings.restarted  === '_') settings.restarted = _('Started!');
            //        if (settings.restarting === undefined || settings.restarting === '_') settings.restarting = _('Restarting...');

            $('.value').each(function () {
                var key = $(this).attr('id');
                var $value = $('#' + key + '.value');
                if ($value.attr('type') === 'checkbox') {
                    $value.prop('checked', settings[key]).on('change', function () {
                        //showHideSettings();
                        onChange();
                    });
                } else {
                    $value.val(settings[key])
                        .on('change', onChange)
                        .on('keyup', function () {
                            onChange();
                        });
                }
            });

            blacklist = settings.blacklist || [];
            sync    = settings.sync    || [];

            onChange(false);
            if (M) M.updateTextFields();

            values2table('blacklist', blacklist, onChange);
            values2table('sync', sync, onChange);
            

            $('#userdiv').on('click', 'a', function () {
                const deleteID = $(this).attr("data-id");
                sendTo(null, 'delUser ' + deleteID, null, function (obj) {
                    $('#' + obj).remove();
                });
            });

            $('#messages').click(function () {
                if ($('#userTable').children().length === 0) {
                    sendTo(null, 'adminuser', null, function (obj) {
                        var text;
                        for (var key in obj) {
                            if (obj.hasOwnProperty(key)) {
                                text += '<tr id="' + key + '"><td>' + key + '</td><td>' + obj[key] + '</td><td><a id="delete" data-id="' + key + '" class="btn-floating waves-effect waves-light red btn-small button-delete"><i class="material-icons">delete</i></a></td></tr>'
                            }
                        }
                        $('#userTable').append(text);
                    });
                }
            });
        }
        

        function save(callback) {
  
            var obj = {};
            $('.value').each(function () {
                var $this = $(this);
                if ($this.attr('type') === 'checkbox') {
                    obj[$this.attr('id')] = $this.prop('checked');
                } else {
                    obj[$this.attr('id')] = $this.val();
                }
            });

            obj.blacklist = table2values('blacklist');
            obj.sync = table2values('sync');
            
            callback(obj);
        }

    </script>
    <style>
        .marg {
            margin-top: 2em;
        }
        .adapter-body {
            overflow: hidden !important;
        }
        table.highlight > tbody > tr {
            transition: background-color .25s ease !important;
        }
        table.highlight > tbody > tr:hover {
            background-color: rgba(200, 200, 200, 0.5) !important;
        }
    </style>
</head>

<body>
    <!-- you have to put your config page in a div with id adapter-container -->
    <div class="m adapter-container">
        <div class="row" style="height: 100%;">
            <div class="col s12">
                <ul class="tabs">
                    <li class="tab col s3"><a href="#tab-main" class="translate active">Main settings</a></li>
                    <li class="tab col s3"><a href="#tab-blackist" class="translate active">Blacklist</a></li>
                    <li class="tab col s3"><a href="#tab-sync" class="translate active">Syncronisation</a></li>
                </ul>
            </div>
            <div id="tab-main" class="col s12 page">
                <div class="row">
                    <div class="col s6">
                        <img src="todoist.png" class="logo" alt="logo"/>
                    </div>
                </div>
                <div class="row">
                     <div class="input-field col s12 m8 l8 polling-settings">
                        <input id="pollingInterval" type="text" class="value" />
                        <label class="translate" for="pollingInterval">Polling interval (ms) use more than 60000 pls.</label>
                        <span></span>
                        
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s12 m8 l8">
                        <input id="token" type="text" class="value" />
                        <label class="translate" for="token">token</label>
                        <span><a href="https://github.com/rde-master/ioBroker.todoist2" target="_blank" class="translate help">Read README.md how to get token</a></span>
                    </div>
                </div>
                <div class="col s12 m12 l12">
                    <h5>Einstellungen</h5>
                    <div class="input-field col s12 m4 l4">
                        <input id="debug" type="checkbox" class="value" />
                        <span class="translate" for="debug">debug</span>
                        <br><span class="translate">debug mode on</span>
                    </div>
                    <div class="input-field col s12 m4 l4">
                        <input id="dublicate" type="checkbox" class="value" />
                        <span class="translate" for="dublicate">Dublikate</span>
                        <br><span class="translate">Bereits angelegte Tasks (Dublikate) nicht erneut anlegen</span>
                    </div>
                    <div class="input-field col s12 m4 l4">
                        <input id="rm_old_objects" type="checkbox" class="value" />
                        <span class="translate" for="dublicate">Remove old Objekts</span>
                        <br><span class="translate">Alte Objekte werden automatisch, ja nach Intravall, gelöscht. (BETA!!!)</span>
                    </div>
                </div>
                <div class="col s12 m12 l12">
                        <h5>Auswahl Anlage Objekte</h5>
                    <div class="input-field col s12 m4 l4">
                        <input id="project" type="checkbox" class="value" />
                        <span class="translate" for="project">Project</span>
                        <br><span class="translate">Projekte als Objekte anlegen</span>
                    </div>
                    <div class="input-field col s12 m4 l4">
                            <input id="section" type="checkbox" class="value" />
                            <span class="translate" for="section">Section</span>
                            <br><span class="translate">Section als Objekte anlegen</span>
                    </div>
                    <div class="input-field col s12 m4 l4">
                            <input id="tasks" type="checkbox" class="value" />
                            <span class="translate" for="tasks">Tasks</span>
                            <br><span class="translate">Tasks als Objekte anlegen</span>
                    </div>
                    <div class="input-field col s12 m4 l4">
                            <input id="labels" type="checkbox" class="value" />
                            <span class="translate" for="labels">Labels</span>
                            <br><span class="translate">Labels als Objekte anlegen</span>
                    </div>
                </div>
                <div class="col s12 m12 l12">
                    <h5>Art der Objekte:</h5>
                    <div class="input-field col s12 m4 l4">
                        <input id="html_objects" type="checkbox" class="value" />
                        <span class="translate" for="html_objects">HTML</span>
                        <br><span class="translate">HTML Objekte anlegen</span>
                    </div>
                    <div class="input-field col s12 m4 l4">
                        <input id="json_objects" type="checkbox" class="value" />
                        <span class="translate" for="json_objects">JSON</span>
                        <br><span class="translate">JSON Objekte anlegen</span>
                    </div>
                    <div class="input-field col s12 m4 l4">
                        <input id="text_objects" type="checkbox" class="value" />
                        <span class="translate" for="text_objects">Text</span>
                        <br><span class="translate">Text Objekte anlegen</span>
                    </div>
                </div>    
            </div>
        
        <div id="tab-blackist" class="col s12 page">    
            <p></p>
            Blacklist: Hier kannst du Blacklist für die einzelnen Bereiche anlegen.
            <p></p>
            <div class="col s12" id="blacklist">
                
                <a class="btn-floating waves-effect waves-light blue table-button-add"><i class="material-icons">add</i></a>
                <div class="table-values-div">
                     <table class="table-values" style="width: 100%;">
                        <thead>
                            <tr>
                                <th id="bl_activ" data-name="activ" data-type="checkbox" style="background: #64b5f6" class="translate">active</th>
                                <th id="bl_id" data-name="id" style="width: 10%; background: #64b5f6" class="translate">Projekt ID</th>
                                <th id="bl_art" data-name="art" style="width: 30%; background: #64b5f6"  class="translate" data-options="project/Projects;label/Labels;section/Secitons" data-type="select">Art</th>
                                <th id="bl_comment" data-name="comment" style="width: 50%; background: #64b5f6" class="translate">Comment</th>
                                <th data-buttons="delete" style="width: 100px; background: #64b5f6"></th>

                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
            
        </div>

        <div id="tab-sync" class="col s12 page">    
            <p></p>
            Syncronisation: Hier kannst du Projekte miteinander Syncornisieren
            <p></p>
            Dublikate können nicht erkannt werden! Bitte Auto delete nutzen, sonst werden ganz viele Todos angelegt.
            <p></p>
            <div class="col s12" id="sync">
                
                <a class="btn-floating waves-effect waves-light blue table-button-add"><i class="material-icons">add</i></a>
                <div class="table-values-div">
                     <table class="table-values" style="width: 100%;">
                        <thead>
                            <tr>
                                <th id="sync_activ" data-name="sync_activ" data-type="checkbox" style="background: #64b5f6" class="translate">active</th>
                                <th id="sync_id_q" data-name="sync_id_q" style="width: 10%; background: #64b5f6" class="translate">Projekt ID Quelle</th>
                                <th id="sync_id_z" data-name="sync_id_z" style="width: 10%; background: #64b5f6" class="translate">Projekt ID Quelle</th>
                                <th id="sync_delete" data-name="sync_delete" data-type="checkbox" style="background: #64b5f6" class="translate">auto delete</th>
                                <th id="sync_comment" data-name="sync_comment" style="width: 50%; background: #64b5f6" class="translate">Comment</th>
                                <th data-buttons="delete" style="width: 100px; background: #64b5f6"></th>

                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
            
        </div>
    </div>
</div>       
</body>

</html>